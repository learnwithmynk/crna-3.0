# Stripe Connect Payment Flows - Visual Guide
## CRNA Club Mentor Marketplace

**Date:** December 7, 2025

This document provides visual representations of all payment flows in the marketplace.

---

## Table of Contents

1. [Standard Booking Flow](#standard-booking-flow)
2. [Authorization & Capture Flow](#authorization--capture-flow)
3. [Refund Scenarios](#refund-scenarios)
4. [Dispute Process](#dispute-process)
5. [Provider Payout Flow](#provider-payout-flow)
6. [Failed Payment Recovery](#failed-payment-recovery)

---

## Standard Booking Flow

### Happy Path: Successful Booking

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 1: APPLICANT BOOKS SERVICE                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Applicant                  Frontend                Backend              Stripe
    â”‚                          â”‚                       â”‚                  â”‚
    â”‚â”€â”€â”€ Browse services â”€â”€â”€â”€â”€â”€>â”‚                       â”‚                  â”‚
    â”‚                          â”‚                       â”‚                  â”‚
    â”‚                          â”‚                       â”‚                  â”‚
    â”‚â”€â”€â”€ Select "Mock Interview - $50" â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                  â”‚
    â”‚                          â”‚                       â”‚                  â”‚
    â”‚                          â”‚                       â”‚                  â”‚
    â”‚<â”€â”€â”€â”€ Show payment form â”€â”€â”‚<â”€â”€â”€â”€ Create booking â”€â”€â”‚                  â”‚
    â”‚                          â”‚      (status: pending)â”‚                  â”‚
    â”‚                          â”‚                       â”‚                  â”‚
    â”‚                          â”‚                       â”‚                  â”‚
    â”‚â”€â”€ Enter card info â”€â”€â”€â”€â”€â”€>â”‚                       â”‚                  â”‚
    â”‚    (Stripe Elements)     â”‚                       â”‚                  â”‚
    â”‚                          â”‚                       â”‚                  â”‚
    â”‚                          â”‚â”€â”€ Tokenize card â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>  â”‚
    â”‚                          â”‚                       â”‚                  â”‚
    â”‚                          â”‚<â”€â”€â”€â”€â”€ Token â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
    â”‚                          â”‚                       â”‚                  â”‚
    â”‚                          â”‚                       â”‚                  â”‚
    â”‚                          â”‚â”€â”€ Confirm booking â”€â”€â”€â”€>â”‚                  â”‚
    â”‚                          â”‚   + payment token     â”‚                  â”‚
    â”‚                          â”‚                       â”‚                  â”‚

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 2: PLATFORM CREATES DESTINATION CHARGE                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Backend                                                         Stripe
    â”‚                                                              â”‚
    â”‚â”€â”€ Create PaymentIntent â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
    â”‚   {                                                          â”‚
    â”‚     amount: 5000,                  // $50.00                â”‚
    â”‚     on_behalf_of: srna_account_id,                          â”‚
    â”‚     transfer_data: {                                        â”‚
    â”‚       destination: srna_account_id,                         â”‚
    â”‚       amount: 4250          // $42.50 (85% to provider)     â”‚
    â”‚     },                                                       â”‚
    â”‚     application_fee_amount: 750  // $7.50 (15% platform)    â”‚
    â”‚   }                                                          â”‚
    â”‚                                                              â”‚
    â”‚<â”€â”€â”€â”€â”€â”€ PaymentIntent created â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
    â”‚        (status: requires_payment_method)                    â”‚
    â”‚                                                              â”‚
    â”‚                                                              â”‚
    â”‚â”€â”€ Confirm PaymentIntent â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
    â”‚   {                                                          â”‚
    â”‚     payment_method: pm_xxx,                                 â”‚
    â”‚     return_url: "https://crnaclub.com/booking/success"      â”‚
    â”‚   }                                                          â”‚
    â”‚                                                              â”‚
    â”‚                                                              â”‚
    â”‚                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
    â”‚                          â”‚  Stripe Processes  â”‚              â”‚
    â”‚                          â”‚  Card Payment      â”‚              â”‚
    â”‚                          â”‚  - Charge $50      â”‚              â”‚
    â”‚                          â”‚  - Take $1.75 fee  â”‚              â”‚
    â”‚                          â”‚  - Queue transfer  â”‚              â”‚
    â”‚                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
    â”‚                                                              â”‚
    â”‚<â”€â”€â”€â”€â”€â”€ Payment succeeded â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
    â”‚        (status: succeeded)                                   â”‚
    â”‚                                                              â”‚
    â”‚                                                              â”‚
    â”‚â”€â”€ Update booking â”€â”€>                                         â”‚
    â”‚   status: paid                                               â”‚
    â”‚   stripe_payment_intent_id                                   â”‚
    â”‚                                                              â”‚

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 3: FUNDS TRANSFERRED TO PROVIDER                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Platform Balance          SRNA Balance               Stripe
    â”‚                          â”‚                          â”‚
    â”‚                          â”‚                          â”‚
    â”‚<â”€â”€â”€â”€ +$50.00 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
    â”‚      (charge received)   â”‚                          â”‚
    â”‚                          â”‚                          â”‚
    â”‚â”€â”€â”€â”€> -$1.75 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
    â”‚      (Stripe fee)        â”‚                          â”‚
    â”‚                          â”‚                          â”‚
    â”‚â”€â”€â”€â”€> -$42.50 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
    â”‚      (transfer to SRNA)  â”‚                          â”‚
    â”‚                          â”‚                          â”‚
    â”‚                          â”‚<â”€â”€â”€â”€ +$42.50 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
    â”‚                          â”‚      (transfer received) â”‚
    â”‚                          â”‚                          â”‚
    â”‚      +$5.75              â”‚      +$42.50             â”‚
    â”‚      (net in platform)   â”‚      (pending payout)    â”‚
    â”‚      = $7.50 app fee     â”‚                          â”‚
    â”‚        - $1.75 Stripe    â”‚                          â”‚
    â”‚                          â”‚                          â”‚

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 4: SERVICE DELIVERED                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

SRNA                     Applicant                Backend
    â”‚                          â”‚                       â”‚
    â”‚â”€â”€ Conduct mock interview â”€â”€â”€â”€>                   â”‚
    â”‚                          â”‚                       â”‚
    â”‚                          â”‚                       â”‚
    â”‚                          â”‚â”€â”€ Mark complete â”€â”€â”€â”€â”€â”€>â”‚
    â”‚                          â”‚                       â”‚
    â”‚                          â”‚                       â”‚
    â”‚<â”€â”€â”€â”€â”€ Service complete notification â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
    â”‚                          â”‚                       â”‚

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 5: PROVIDER RECEIVES PAYOUT (Weekly schedule)                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Stripe                   SRNA Bank                SRNA
    â”‚                          â”‚                       â”‚
    â”‚                          â”‚                       â”‚
    â”‚â”€â”€ Monday payout â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                       â”‚
    â”‚   $42.50                 â”‚                       â”‚
    â”‚   - $0.23 payout fee     â”‚                       â”‚
    â”‚   = $42.27               â”‚                       â”‚
    â”‚                          â”‚                       â”‚
    â”‚                          â”‚                       â”‚
    â”‚                          â”‚<â”€â”€ $42.27 arrives â”€â”€â”€â”€â”‚
    â”‚                          â”‚   (2 business days)   â”‚
    â”‚                          â”‚                       â”‚
```

**Summary:**
- Applicant pays $50.00
- Stripe keeps $1.75 (card processing)
- Platform keeps $7.50 (15% fee)
- Transfer to SRNA: $40.75
- Payout fee: $0.23
- SRNA receives: $40.52 net

---

## Authorization & Capture Flow

### For Future Bookings (Hold Payment Until Service Complete)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 1: AUTHORIZE PAYMENT (Book for future date)                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Applicant                Backend                  Stripe
    â”‚                        â”‚                        â”‚
    â”‚â”€â”€ Book service â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                        â”‚
    â”‚   (scheduled 3 days)   â”‚                        â”‚
    â”‚                        â”‚                        â”‚
    â”‚                        â”‚â”€â”€ Create PaymentIntent â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
    â”‚                        â”‚   {                                 â”‚
    â”‚                        â”‚     amount: 5000,                   â”‚
    â”‚                        â”‚     capture_method: 'manual', ğŸ”‘    â”‚
    â”‚                        â”‚     ...                             â”‚
    â”‚                        â”‚   }                                 â”‚
    â”‚                        â”‚                                     â”‚
    â”‚                        â”‚<â”€â”€â”€ PaymentIntent â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
    â”‚                        â”‚                                     â”‚
    â”‚<â”€â”€â”€ Enter payment â”€â”€â”€â”€â”€â”‚                                     â”‚
    â”‚                        â”‚                                     â”‚
    â”‚                        â”‚                                     â”‚
    â”‚â”€â”€â”€ Submit card â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                                     â”‚
    â”‚                        â”‚                                     â”‚
    â”‚                        â”‚â”€â”€ Confirm PaymentIntent â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€> â”‚
    â”‚                        â”‚                                     â”‚
    â”‚                        â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
    â”‚                        â”‚      â”‚ Stripe HOLDS $50 â”‚           â”‚
    â”‚                        â”‚      â”‚ Not yet charged  â”‚           â”‚
    â”‚                        â”‚      â”‚ Valid for 7 days â”‚           â”‚
    â”‚                        â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
    â”‚                        â”‚                                     â”‚
    â”‚                        â”‚<â”€â”€â”€ Authorization succeeded â”€â”€â”€â”€â”€â”€â”€â”€â”‚
    â”‚                        â”‚     (status: requires_capture)      â”‚
    â”‚                        â”‚                                     â”‚
    â”‚<â”€â”€â”€ Booking confirmed â”€â”‚                                     â”‚
    â”‚     "Hold placed"      â”‚                                     â”‚
    â”‚                        â”‚                                     â”‚

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 2: CAPTURE AFTER SERVICE (3 days later)                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

SRNA                     Applicant                Backend              Stripe
    â”‚                        â”‚                        â”‚                  â”‚
    â”‚â”€â”€ Deliver service â”€â”€â”€â”€â”€>â”‚                        â”‚                  â”‚
    â”‚                        â”‚                        â”‚                  â”‚
    â”‚                        â”‚                        â”‚                  â”‚
    â”‚                        â”‚â”€â”€ Confirm completion â”€â”€>â”‚                  â”‚
    â”‚                        â”‚   (or auto-confirm     â”‚                  â”‚
    â”‚                        â”‚    24h after service)  â”‚                  â”‚
    â”‚                        â”‚                        â”‚                  â”‚
    â”‚                        â”‚                        â”‚â”€â”€ Capture â”€â”€â”€â”€â”€â”€>â”‚
    â”‚                        â”‚                        â”‚   PaymentIntent  â”‚
    â”‚                        â”‚                        â”‚                  â”‚
    â”‚                        â”‚                        â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                        â”‚                        â”‚      â”‚ NOW charge $50 â”‚
    â”‚                        â”‚                        â”‚      â”‚ Transfer funds â”‚
    â”‚                        â”‚                        â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚                        â”‚                        â”‚                  â”‚
    â”‚                        â”‚                        â”‚<â”€â”€â”€ Captured â”€â”€â”€â”€â”‚
    â”‚                        â”‚                        â”‚                  â”‚
    â”‚                        â”‚<â”€â”€â”€ Payment confirmed â”€â”‚                  â”‚
    â”‚                        â”‚                        â”‚                  â”‚
    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€ Pending payout notification â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                  â”‚
    â”‚                        â”‚                        â”‚                  â”‚

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ALTERNATIVE: CANCEL AUTHORIZATION (Customer cancels)                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Applicant                Backend                  Stripe
    â”‚                        â”‚                        â”‚
    â”‚â”€â”€ Cancel booking â”€â”€â”€â”€â”€â”€>â”‚                        â”‚
    â”‚   (before service)     â”‚                        â”‚
    â”‚                        â”‚                        â”‚
    â”‚                        â”‚â”€â”€ Cancel PaymentIntent â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
    â”‚                        â”‚                                     â”‚
    â”‚                        â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
    â”‚                        â”‚      â”‚ Release hold     â”‚           â”‚
    â”‚                        â”‚      â”‚ No charge made   â”‚           â”‚
    â”‚                        â”‚      â”‚ Customer's card  â”‚           â”‚
    â”‚                        â”‚      â”‚ available again  â”‚           â”‚
    â”‚                        â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
    â”‚                        â”‚                                     â”‚
    â”‚                        â”‚<â”€â”€â”€ Cancelled â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
    â”‚                        â”‚                                     â”‚
    â”‚<â”€â”€â”€ Booking cancelled â”€â”‚                                     â”‚
    â”‚     "No charge"        â”‚                                     â”‚
    â”‚                        â”‚                                     â”‚
```

**Benefits:**
- âœ… Funds guaranteed (card authorized)
- âœ… Customer not charged if they cancel
- âœ… No refund needed for pre-service cancellations
- âœ… Reduces chargeback risk (charge after service delivered)

**Limitations:**
- âš ï¸ 7-day maximum hold (or 30 with extended auth)
- âš ï¸ If authorization expires, must create new payment

---

## Refund Scenarios

### Scenario A: Full Refund Before Transfer

```
Applicant cancels 24h+ before service
Booking status: Paid, not yet transferred to SRNA

Backend                              Stripe                  SRNA Balance
    â”‚                                    â”‚                        â”‚
    â”‚â”€â”€ Issue refund â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                        â”‚
    â”‚   {                                â”‚                        â”‚
    â”‚     payment_intent: pi_xxx,        â”‚                        â”‚
    â”‚     amount: 5000,  // Full refund  â”‚                        â”‚
    â”‚   }                                â”‚                        â”‚
    â”‚                                    â”‚                        â”‚
    â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
    â”‚                    â”‚ Stripe reverses charge     â”‚            â”‚
    â”‚                    â”‚ - Applicant gets $50 back  â”‚            â”‚
    â”‚                    â”‚ - Platform fee returned    â”‚            â”‚
    â”‚                    â”‚ - Stripe fee NOT returned  â”‚            â”‚
    â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
    â”‚                                    â”‚                        â”‚
    â”‚<â”€â”€â”€ Refund succeeded â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                        â”‚
    â”‚                                    â”‚                        â”‚
    â”‚                                    â”‚                        â”‚
    â”‚                                                              â”‚
    â”‚                    (SRNA never received funds)               â”‚
    â”‚                                                              â”‚

Result:
- Applicant: +$50 (refunded)
- Platform: -$1.75 (Stripe fee not refunded)
- SRNA: $0 (never received)
```

### Scenario B: Full Refund After Transfer (SRNA No-Show)

```
SRNA no-show, applicant requests refund
Booking status: Paid, already transferred to SRNA

Backend                              Stripe                  SRNA Balance
    â”‚                                    â”‚                        â”‚
    â”‚                                    â”‚                        â”‚
    â”‚â”€â”€ Issue refund with reverse â”€â”€â”€â”€â”€â”€â”€>â”‚                        â”‚
    â”‚   {                                â”‚                        â”‚
    â”‚     payment_intent: pi_xxx,        â”‚                        â”‚
    â”‚     reverse_transfer: true, ğŸ”‘     â”‚                        â”‚
    â”‚   }                                â”‚                        â”‚
    â”‚                                    â”‚                        â”‚
    â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
    â”‚                    â”‚ Stripe processes refund    â”‚            â”‚
    â”‚                    â”‚ 1. Refund $50 to applicant â”‚            â”‚
    â”‚                    â”‚ 2. Reverse transfer        â”‚            â”‚
    â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
    â”‚                                    â”‚                        â”‚
    â”‚                                    â”‚                        â”‚
    â”‚                                    â”‚â”€â”€ Debit transfer â”€â”€â”€â”€â”€â”€>â”‚
    â”‚                                    â”‚   amount (-$42.50)     â”‚
    â”‚                                    â”‚                        â”‚
    â”‚                                    â”‚                        â”‚
    â”‚                                                   Balance: -$42.50
    â”‚                                                   (negative!)
    â”‚                                    â”‚                        â”‚
    â”‚<â”€â”€â”€ Refund succeeded â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                        â”‚
    â”‚                                    â”‚                        â”‚

Next payout deducts negative balance:
    â”‚                                    â”‚                        â”‚
    â”‚    SRNA earns $50 from new booking â”‚                        â”‚
    â”‚                                    â”‚â”€â”€> +$42.50 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
    â”‚                                    â”‚                        â”‚
    â”‚                                                   Balance: $0
    â”‚                                    â”‚   (offset by negative)  â”‚
    â”‚                                    â”‚                        â”‚
    â”‚                                    â”‚                        â”‚
    â”‚â”€â”€ Payout (Monday) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                        â”‚
    â”‚                                    â”‚                        â”‚
    â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
    â”‚                    â”‚ No payout sent             â”‚            â”‚
    â”‚                    â”‚ Balance is $0              â”‚            â”‚
    â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
    â”‚                                    â”‚                        â”‚

Result:
- Applicant: +$50 (refunded)
- Platform: -$1.75 (Stripe fee)
- SRNA: $0 (earnings offset debt)
```

### Scenario C: Partial Refund (<24h cancellation)

```
Applicant cancels 12h before service
Policy: 50% refund to customer, 50% to SRNA as cancellation fee

Backend                              Stripe
    â”‚                                    â”‚
    â”‚â”€â”€ Issue partial refund â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
    â”‚   {                                â”‚
    â”‚     payment_intent: pi_xxx,        â”‚
    â”‚     amount: 2500,  // 50% = $25    â”‚
    â”‚   }                                â”‚
    â”‚                                    â”‚
    â”‚<â”€â”€â”€ Refund succeeded â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
    â”‚                                    â”‚
    â”‚                                    â”‚
    â”‚â”€â”€ Create new transfer â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
    â”‚   {                                â”‚
    â”‚     amount: 2125,  // 85% of $25   â”‚
    â”‚     destination: srna_account,     â”‚
    â”‚   }                                â”‚
    â”‚                                    â”‚
    â”‚<â”€â”€â”€ Transfer created â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
    â”‚                                    â”‚

Result:
- Applicant: +$25 (partial refund)
- Platform: $3.75 - $1.75 = $2.00 net
  ($7.50 original fee â†’ $3.75 on $25, minus Stripe fee not refunded)
- SRNA: ~$21 (50% of booking as cancellation fee)
```

---

## Dispute Process

### Chargeback Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ TIMELINE: Applicant files chargeback                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Day 0: Service completed, SRNA paid out
Day 14: Applicant contacts bank: "I didn't receive the service"
Day 15: Bank files chargeback with Stripe

Stripe                   Platform                 Admin/SRNA
    â”‚                        â”‚                          â”‚
    â”‚â”€â”€ Webhook: charge.dispute.created â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
    â”‚   {                                                â”‚
    â”‚     id: dp_xxx,                                    â”‚
    â”‚     amount: 5000,                                  â”‚
    â”‚     reason: "service_not_provided",                â”‚
    â”‚     status: "needs_response",                      â”‚
    â”‚     evidence_due_by: Day 22                        â”‚
    â”‚   }                                                â”‚
    â”‚                                                    â”‚
    â”‚                        â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
    â”‚                        â”‚  (webhook stored in DB)  â”‚
    â”‚                        â”‚                          â”‚
    â”‚                        â”‚                          â”‚
    â”‚                        â”‚â”€â”€> Notify admin â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
    â”‚                        â”‚    "New dispute!"        â”‚
    â”‚                        â”‚                          â”‚
    â”‚                        â”‚                          â”‚
    â”‚                        â”‚<â”€â”€â”€ Contact SRNA â”€â”€â”€â”€â”€â”€â”€â”€â”‚
    â”‚                        â”‚    "Need evidence"       â”‚
    â”‚                        â”‚                          â”‚

Day 16-20: Gather evidence
    â”‚                        â”‚                          â”‚
    â”‚                        â”‚<â”€â”€â”€ SRNA provides â”€â”€â”€â”€â”€â”€â”€â”‚
    â”‚                        â”‚    - Booking confirmationâ”‚
    â”‚                        â”‚    - Session notes       â”‚
    â”‚                        â”‚    - Messages            â”‚
    â”‚                        â”‚    - Timestamp proof     â”‚
    â”‚                        â”‚                          â”‚

Day 21: Submit evidence to Stripe
    â”‚                        â”‚                          â”‚
    â”‚<â”€â”€â”€ Submit evidence â”€â”€â”€â”‚                          â”‚
    â”‚   {                    â”‚                          â”‚
    â”‚     evidence: {        â”‚                          â”‚
    â”‚       customer_name,   â”‚                          â”‚
    â”‚       customer_email,  â”‚                          â”‚
    â”‚       service_date,    â”‚                          â”‚
    â”‚       product_description,                        â”‚
    â”‚       receipt,         â”‚                          â”‚
    â”‚     }                  â”‚                          â”‚
    â”‚   }                    â”‚                          â”‚
    â”‚                        â”‚                          â”‚
    â”‚â”€â”€> Evidence received â”€â”€>â”‚                          â”‚
    â”‚                        â”‚                          â”‚

Day 22-60: Stripe + Bank review
    â”‚                        â”‚                          â”‚
    â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
    â”‚   â”‚ Card network reviews evidence   â”‚             â”‚
    â”‚   â”‚ Bank makes final decision       â”‚             â”‚
    â”‚   â”‚ 30-60 day process               â”‚             â”‚
    â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
    â”‚                        â”‚                          â”‚

Day 60: Dispute resolved
    â”‚                        â”‚                          â”‚
    â”‚â”€â”€ Webhook: charge.dispute.closed â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
    â”‚   {                                                â”‚
    â”‚     status: "won" OR "lost"                        â”‚
    â”‚   }                                                â”‚
    â”‚                        â”‚                          â”‚

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ OUTCOME A: DISPUTE WON (in platform's favor)                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    â”‚                        â”‚                          â”‚
    â”‚â”€â”€ Funds returned â”€â”€â”€â”€â”€â”€>â”‚                          â”‚
    â”‚   (disputed $50)       â”‚                          â”‚
    â”‚                        â”‚                          â”‚
    â”‚                        â”‚â”€â”€> Notify all â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
    â”‚                        â”‚    "Dispute won!"        â”‚
    â”‚                        â”‚                          â”‚

Result:
- Platform keeps dispute amount
- SRNA keeps earnings (no change)
- $15 dispute fee refunded

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ OUTCOME B: DISPUTE LOST (applicant wins)                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    â”‚                        â”‚                          â”‚
    â”‚â”€â”€ Deduct from platform â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€> â”‚
    â”‚   $50 + $15 fee        â”‚                          â”‚
    â”‚                        â”‚                          â”‚
    â”‚                        â”‚â”€â”€> Notify SRNA â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
    â”‚                        â”‚    "Dispute lost"        â”‚
    â”‚                        â”‚                          â”‚
    â”‚                        â”‚<â”€â”€â”€ Deduct from SRNA â”€â”€â”€â”€â”‚
    â”‚                        â”‚    future earnings       â”‚
    â”‚                        â”‚                          â”‚
    â”‚<â”€â”€â”€ Create negative balance â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
    â”‚    on SRNA account     â”‚                          â”‚
    â”‚    (-$42.50)           â”‚                          â”‚
    â”‚                        â”‚                          â”‚

Result:
- Applicant keeps $50 (refunded by bank)
- Platform loses $50 + $15 fee
- SRNA loses $42.50 (deducted from balance)
- Platform absorbs Stripe fees ($1.75)
```

**Dispute Prevention:**
- âœ… Send confirmation emails with service details
- âœ… Require service completion confirmation
- âœ… Keep message logs between applicant and SRNA
- âœ… Have SRNA take session notes
- âœ… Use 3D Secure for high-value transactions

---

## Provider Payout Flow

### Weekly Payout Schedule

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ WEEK VIEW: SRNA earnings accumulation                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Monday (Payout Day)     Balance: $0
    â”‚
Tuesday                 Booking 1 completed â†’ +$40.75
    â”‚                   Balance: $40.75 (pending)
    â”‚
Wednesday               Booking 2 completed â†’ +40.75
    â”‚                   Balance: $81.50 (pending)
    â”‚
Thursday                Booking 3 completed â†’ +40.75
    â”‚                   Balance: $122.25 (pending)
    â”‚
Friday                  (no bookings)
    â”‚                   Balance: $122.25 (pending)
    â”‚
Saturday                Booking 4 completed â†’ +40.75
    â”‚                   Balance: $163.00 (pending)
    â”‚
Sunday                  (no bookings)
    â”‚                   Balance: $163.00 (pending)
    â”‚
Monday (Payout Day)     ğŸ‰ PAYOUT INITIATED
    â”‚
    â”‚
    â–¼

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PAYOUT PROCESS                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Stripe                   SRNA Balance            SRNA Bank
    â”‚                        â”‚                        â”‚
    â”‚                        â”‚                        â”‚
    â”‚â”€â”€ Monday 00:00 UTC â”€â”€â”€â”€>â”‚                        â”‚
    â”‚   Payout scheduled     â”‚                        â”‚
    â”‚                        â”‚                        â”‚
    â”‚                        â”‚  Balance: $163.00      â”‚
    â”‚                        â”‚                        â”‚
    â”‚â”€â”€ Calculate payout â”€â”€â”€â”€>â”‚                        â”‚
    â”‚   Amount: $163.00      â”‚                        â”‚
    â”‚   Fee: 0.25% + $0.25   â”‚                        â”‚
    â”‚       = $0.66          â”‚                        â”‚
    â”‚   Net: $162.34         â”‚                        â”‚
    â”‚                        â”‚                        â”‚
    â”‚                        â”‚                        â”‚
    â”‚â”€â”€ Debit balance â”€â”€â”€â”€â”€â”€â”€>â”‚                        â”‚
    â”‚                        â”‚                        â”‚
    â”‚                        â”‚  Balance: $0           â”‚
    â”‚                        â”‚  (payout in transit)   â”‚
    â”‚                        â”‚                        â”‚
    â”‚                        â”‚                        â”‚
    â”‚â”€â”€ ACH transfer â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
    â”‚   $162.34              â”‚                        â”‚
    â”‚                        â”‚                        â”‚
    â”‚                        â”‚                        â”‚
    â”‚â”€â”€ Webhook: payout.paid â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€> â”‚
    â”‚   {                    â”‚                        â”‚
    â”‚     amount: 16234,     â”‚                        â”‚
    â”‚     arrival_date: Wed  â”‚                        â”‚
    â”‚   }                    â”‚                        â”‚
    â”‚                        â”‚                        â”‚
    â”‚                        â”‚                        â”‚
    â”‚                        â”‚    Wednesday (T+2)     â”‚
    â”‚                        â”‚    Funds arrive â”€â”€â”€â”€â”€â”€â”€>â”‚
    â”‚                        â”‚                   $162.34
    â”‚                        â”‚                        â”‚
```

### Instant Payout (On-Demand)

```
SRNA Dashboard           Backend                 Stripe              SRNA Bank
    â”‚                        â”‚                       â”‚                  â”‚
    â”‚                        â”‚                       â”‚                  â”‚
    â”‚â”€â”€ Click "Instant Payout"                      â”‚                  â”‚
    â”‚                        â”‚                       â”‚                  â”‚
    â”‚                        â”‚  Check balance        â”‚                  â”‚
    â”‚                        â”‚  Balance: $82.00      â”‚                  â”‚
    â”‚                        â”‚                       â”‚                  â”‚
    â”‚<â”€â”€â”€ Confirm â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                       â”‚                  â”‚
    â”‚   "Get $80.77 now?"    â”‚  Calculate:           â”‚                  â”‚
    â”‚   (1.5% fee = $1.23)   â”‚  $82 - 1.5% = $80.77  â”‚                  â”‚
    â”‚                        â”‚                       â”‚                  â”‚
    â”‚                        â”‚                       â”‚                  â”‚
    â”‚â”€â”€ Confirm â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                       â”‚                  â”‚
    â”‚                        â”‚                       â”‚                  â”‚
    â”‚                        â”‚â”€â”€ Create instant payout â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>   â”‚
    â”‚                        â”‚   {                                      â”‚
    â”‚                        â”‚     amount: 8200,                        â”‚
    â”‚                        â”‚     method: 'instant'                    â”‚
    â”‚                        â”‚   }                                      â”‚
    â”‚                        â”‚                                          â”‚
    â”‚                        â”‚                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
    â”‚                        â”‚                   â”‚ Stripe processes â”‚   â”‚
    â”‚                        â”‚                   â”‚ instant payout   â”‚   â”‚
    â”‚                        â”‚                   â”‚ - Debit balance  â”‚   â”‚
    â”‚                        â”‚                   â”‚ - Apply 1.5% fee â”‚   â”‚
    â”‚                        â”‚                   â”‚ - Send to bank   â”‚   â”‚
    â”‚                        â”‚                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
    â”‚                        â”‚                                          â”‚
    â”‚                        â”‚<â”€â”€â”€ Payout created â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚
    â”‚                        â”‚                                          â”‚
    â”‚                        â”‚â”€â”€ Webhook: payout.paid â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>   â”‚
    â”‚                        â”‚                                          â”‚
    â”‚<â”€â”€â”€ Success â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                                          â”‚
    â”‚   "Funds arriving      â”‚                                          â”‚
    â”‚    in ~30 minutes"     â”‚                                          â”‚
    â”‚                        â”‚                                          â”‚
    â”‚                        â”‚                                          â”‚
    â”‚                        â”‚              30 minutes later            â”‚
    â”‚                        â”‚              Funds arrive â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
    â”‚                        â”‚                                    $80.77 â”‚
    â”‚                        â”‚                                          â”‚

Breakdown:
- Pending balance: $82.00
- Instant payout fee (1.5%): $1.23
- Net to bank: $80.77
- Arrival time: ~30 minutes
```

**Instant Payout Limits:**
- Maximum 10 per day
- Available after 60 days on platform
- Supported in US, UK, Canada, Singapore
- Debit card or supported bank account only

---

## Failed Payment Recovery

### Card Declined â†’ Retry Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ATTEMPT 1: Initial payment fails                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Applicant                Backend                  Stripe
    â”‚                        â”‚                        â”‚
    â”‚â”€â”€ Submit booking â”€â”€â”€â”€â”€â”€>â”‚                        â”‚
    â”‚                        â”‚                        â”‚
    â”‚                        â”‚â”€â”€ Create PaymentIntent â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
    â”‚                        â”‚                                     â”‚
    â”‚                        â”‚<â”€â”€â”€ Requires payment method â”€â”€â”€â”€â”€â”€â”€â”€â”‚
    â”‚                        â”‚                                     â”‚
    â”‚                        â”‚                                     â”‚
    â”‚<â”€â”€â”€ Payment form â”€â”€â”€â”€â”€â”€â”‚                                     â”‚
    â”‚                        â”‚                                     â”‚
    â”‚â”€â”€ Enter card â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                                     â”‚
    â”‚   (card: 4000 0000     â”‚                                     â”‚
    â”‚    0000 0002)          â”‚                                     â”‚
    â”‚   [declined test card] â”‚                                     â”‚
    â”‚                        â”‚                                     â”‚
    â”‚                        â”‚â”€â”€ Confirm payment â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
    â”‚                        â”‚                                     â”‚
    â”‚                        â”‚                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
    â”‚                        â”‚                   â”‚ Card network â”‚  â”‚
    â”‚                        â”‚                   â”‚ DECLINES     â”‚  â”‚
    â”‚                        â”‚                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
    â”‚                        â”‚                                     â”‚
    â”‚                        â”‚<â”€â”€â”€ Payment failed â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
    â”‚                        â”‚     {                               â”‚
    â”‚                        â”‚       error: "card_declined",       â”‚
    â”‚                        â”‚       decline_code: "generic_decline"â”‚
    â”‚                        â”‚     }                               â”‚
    â”‚                        â”‚                                     â”‚
    â”‚                        â”‚                                     â”‚
    â”‚<â”€â”€â”€ Error message â”€â”€â”€â”€â”€â”‚                                     â”‚
    â”‚   "Your card was      â”‚                                     â”‚
    â”‚    declined. Please   â”‚                                     â”‚
    â”‚    try another card." â”‚                                     â”‚
    â”‚                        â”‚                                     â”‚
    â”‚                        â”‚â”€â”€ Update booking â”€â”€â”€>               â”‚
    â”‚                        â”‚   status: payment_failed            â”‚
    â”‚                        â”‚   retry_count: 1                    â”‚
    â”‚                        â”‚                                     â”‚

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ATTEMPT 2: Customer tries different card                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    â”‚                        â”‚                                     â”‚
    â”‚<â”€â”€â”€ Show retry UI â”€â”€â”€â”€â”€â”‚                                     â”‚
    â”‚   "Try different card" â”‚                                     â”‚
    â”‚                        â”‚                                     â”‚
    â”‚                        â”‚                                     â”‚
    â”‚â”€â”€ New card â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                                     â”‚
    â”‚   (card: 4242 4242     â”‚                                     â”‚
    â”‚    4242 4242)          â”‚                                     â”‚
    â”‚   [success test card]  â”‚                                     â”‚
    â”‚                        â”‚                                     â”‚
    â”‚                        â”‚                                     â”‚
    â”‚                        â”‚â”€â”€ Confirm payment â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
    â”‚                        â”‚   (same PaymentIntent)              â”‚
    â”‚                        â”‚   (new payment_method)              â”‚
    â”‚                        â”‚                                     â”‚
    â”‚                        â”‚<â”€â”€â”€ Payment succeeded â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
    â”‚                        â”‚                                     â”‚
    â”‚                        â”‚                                     â”‚
    â”‚<â”€â”€â”€ Success! â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                                     â”‚
    â”‚   "Booking confirmed" â”‚                                     â”‚
    â”‚                        â”‚                                     â”‚
    â”‚                        â”‚â”€â”€ Update booking â”€â”€â”€>               â”‚
    â”‚                        â”‚   status: paid                      â”‚
    â”‚                        â”‚                                     â”‚

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ALTERNATIVE: Email recovery (customer abandons)                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

If customer closes browser without retrying:

    â”‚                        â”‚                                     â”‚
    â”‚   X (browser closed)   â”‚                                     â”‚
    â”‚                        â”‚                                     â”‚
    â”‚                        â”‚                                     â”‚
    â”‚                        â”‚â”€â”€ Cron job (1h later) â”€â”€>           â”‚
    â”‚                        â”‚   Find payment_failed bookings      â”‚
    â”‚                        â”‚                                     â”‚
    â”‚                        â”‚â”€â”€ Send recovery email â”€â”€>           â”‚
    â”‚                        â”‚   "Complete your booking"           â”‚
    â”‚                        â”‚   [Retry Payment Link]              â”‚
    â”‚                        â”‚                                     â”‚
    â”‚                        â”‚                                     â”‚
    â”‚<â”€â”€â”€ Email â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
    â”‚   Click retry link     â”‚                                     â”‚
    â”‚                        â”‚                                     â”‚
    â”‚â”€â”€ Return to site â”€â”€â”€â”€â”€â”€>â”‚                                     â”‚
    â”‚                        â”‚                                     â”‚
    â”‚<â”€â”€â”€ Payment form â”€â”€â”€â”€â”€â”€â”‚  (pre-filled booking info)          â”‚
    â”‚                        â”‚                                     â”‚
    â”‚   [Retry or abandon]   â”‚                                     â”‚
    â”‚                        â”‚                                     â”‚
    â”‚                        â”‚                                     â”‚
    â”‚                        â”‚â”€â”€ Delete booking (24h later) â”€â”€>    â”‚
    â”‚                        â”‚   if still not paid                 â”‚
    â”‚                        â”‚                                     â”‚
```

**Decline Codes & Actions:**

| Decline Code | Message | Action |
|--------------|---------|--------|
| `insufficient_funds` | "Insufficient funds" | Suggest different card |
| `card_not_supported` | "Card type not supported" | Suggest debit/credit card |
| `expired_card` | "Card expired" | Update expiration date |
| `incorrect_cvc` | "Incorrect CVC" | Re-enter CVC |
| `processing_error` | "Try again" | Retry same card |
| `generic_decline` | "Card declined" | Try different card |

---

## Summary

This document covers all major payment flows in the CRNA Club marketplace:

1. **Standard Booking:** Immediate charge and transfer
2. **Authorization & Capture:** Hold for future bookings
3. **Refunds:** Full, partial, before/after transfer
4. **Disputes:** Chargeback process and evidence submission
5. **Payouts:** Weekly automatic and instant on-demand
6. **Failed Payments:** Retry and recovery flows

**Key Takeaways:**
- Use **destination charges** for 1:1 bookings
- Use **authorization & capture** for future appointments
- Always use **`reverse_transfer: true`** when refunding after payout
- Handle **negative balances** by offsetting future earnings
- Gather **evidence immediately** when disputes occur
- Offer **weekly payouts** as default, instant as premium option
- Implement **retry logic** with email recovery for failed payments

**Next Steps:**
- Reference full implementation guide for API details
- Design UI flows based on these diagrams
- Plan error handling for each failure scenario
- Test with Stripe test cards before production

---

**Related Documents:**
- Full Implementation Guide: `/docs/reference/stripe-connect-implementation-guide.md`
- Executive Summary: `/docs/reference/stripe-connect-executive-summary.md`
